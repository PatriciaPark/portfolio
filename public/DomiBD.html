<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ‚</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ERMVPRYRJX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ERMVPRYRJX');
</script>
<title>HBD Hyun Ik</title>
<style>
  :root{ --bg:#0a0f1a; --star:#cfe8ff; --accent:#ffd166; --text:#f6f7fb; --soft:#9fb4d1; }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);
    font-family:"Press Start 2P",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans,Apple SD Gothic Neo,"ë§‘ì€ ê³ ë”•",Helvetica,Arial,sans-serif;}
  .scene{position:relative;min-height:100dvh;overflow:hidden;}

  /* ë³„ */
  .stars{position:absolute;inset:0;overflow:hidden;z-index:0}
  .star{position:absolute;width:2px;height:2px;background:var(--star);opacity:.7;border-radius:50%;animation:twinkle 2.4s infinite}
  @keyframes twinkle{0%,100%{opacity:.2}50%{opacity:1}}

  /* ê³ ì • ìš”ì†Œ */
  .sun{position:fixed;right:12px;top:10px;font-size:28px;filter:drop-shadow(0 0 8px #ffd166aa);animation:pulse 2.2s infinite}
  .earth{position:fixed;left:12px;bottom:12px;font-size:30px;filter:drop-shadow(0 0 6px #97d2ff88);transform-origin:center center}
  @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
  .earth.launchable{cursor:pointer;animation:pulse 1.4s infinite}

  /* í—¤ë” */
  .header{position:relative;z-index:2;padding:78px 10px 16px;text-align:center;}
  .sub{margin-top:20px;color:var(--soft);font-family:'IBM Plex Sans KR',sans-serif;}

  /* ë„¤ì˜¨ íƒ€ì´í‹€ */
  .neon{
    --neon:#9ff3ff;
    color:var(--neon);
    filter:drop-shadow(0 0 18px rgba(159,243,255,.45));
    font-family:'Orbitron',sans-serif;
    font-weight:800;
    font-size:clamp(23px,4vw,40px);
    letter-spacing:.02em;
    text-shadow:
      0 0 6px rgba(159,243,255,.85),
      0 0 12px rgba(159,243,255,.55),
      0 0 20px rgba(108,222,238,.35),
      0 0 36px rgba(108,222,238,.25);
  }

  /* ===== ì¹´ë“œ ìºëŸ¬ì…€ ===== */
  .carousel{position:relative;z-index:4;margin:10px auto;max-width:560px;overflow:hidden;}
  .slides{display:flex;transition:transform .5s cubic-bezier(.2,.8,.2,1);will-change:transform}
  .slide{min-width:100%;box-sizing:border-box;padding:0 0 8px}

  /* ì¹´ë“œ */
  .card{position:relative;margin:0 auto;padding:20px 16px;max-width:520px;border:1px solid #2a3144;
    border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));backdrop-filter:blur(2px)}
  .dear{margin-bottom:10px;color:#ffdede;padding-left:10px}
  .msg{font-family:'Gowun Dodum',sans-serif;font-size:clamp(15px,2.4vw,16px);line-height:1.75;white-space:pre-line;padding-left:35px}
  .sig{margin-top:10px;color:#ffdede;margin-left:auto;text-align: right; padding-right: 10px;}

  /* ì‚¬ëŒë“¤ (ì¹´ë“œ ìœ„) */
  .people{position:fixed;inset:0;z-index:4;overflow:hidden}
  .person{position:absolute;font-size:26px;cursor:pointer;user-select:none;
    transition:transform 1.2s ease,opacity 1.2s ease,left 1.2s ease,top 1.2s ease;animation:float 8s ease-in-out infinite}
  @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-15px)}100%{transform:translateY(0)}}
  .person.to-earth{opacity:.2;transform:scale(.7)}
  .counter{position:fixed;left:10px;top:10px;font-size:12px;color:#b7c7e6;background:#111a2a;border:1px solid #23314a;
    padding:6px 9px;border-radius:10px;z-index:3}

  /* í”¼ë‚ ë ˆ */
  .final{display:none;position:fixed;inset:0;align-items:center;justify-content:center;z-index:4;opacity:0;pointer-events:none;}
  .final.show{display:flex;opacity:1;transition:opacity .7s ease;pointer-events:none;}
  .final .bubble{
    position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
    padding:16px 20px;border-radius:14px;background:#0f1830cc;border:1px solid #2a3a58;backdrop-filter:blur(6px);
    font-size:clamp(18px,4vw,24px);text-align:center;line-height:1.6;cursor:grab;user-select:none;
    box-shadow:0 0 16px rgba(160,200,255,.35), 0 0 32px rgba(160,200,255,.15);
    box-sizing:border-box; pointer-events:auto;
    min-width:260px; white-space:normal; word-break:keep-all; touch-action:none;
    color:#9ff3ff; font-family:'IBM Plex Sans KR',sans-serif;
  }
  .final .bubble.glow{animation:glow 2.4s ease-in-out infinite alternate}
  @keyframes glow{from{box-shadow:0 0 16px rgba(160,200,255,.35),0 0 32px rgba(160,200,255,.15)}to{box-shadow:0 0 24px rgba(160,200,255,.55),0 0 48px rgba(160,200,255,.25)}}
  .final .bubble::before{content:"";position:absolute;inset:-18px;border-radius:inherit;z-index:-1;
    background:radial-gradient(circle at 50% 50%, rgba(160,200,255,.25), rgba(160,200,255,0) 60%);filter:blur(8px);}

  /* ë¡œì¼“ & í­ë°œ */
  .rocket{position:fixed;left:24px;bottom:34px;font-size:28px;transform:translate(0,0) rotate(-12deg);opacity:0;z-index:4;transition:opacity .2s ease}
  .rocket.launch{opacity:1;animation:launch var(--rocket-duration, 2400ms) cubic-bezier(.25,.8,.25,1) forwards}
  @keyframes launch{to{transform:translate(var(--tx),var(--ty)) rotate(-12deg)}}
  .explosion{position:fixed;left:0;top:0;transform:translate(-50%,-50%) scale(.6);font-size:36px;z-index:5;opacity:0;animation:boom .9s ease-out forwards}
  @keyframes boom{0%{opacity:0;transform:translate(-50%,-50%) scale(.6)}20%{opacity:1;transform:translate(-50%,-50%) scale(1.2)}100%{opacity:0;transform:translate(-50%,-50%) scale(.8)}}

  /* í­ì£½ */
  .burst{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);pointer-events:none;z-index:4}
  .confetti{position:absolute;font-size:22px;animation:pop 1.8s ease forwards;opacity:0}
  @keyframes pop{0%{transform:translate(0,0) scale(.6);opacity:0}15%{opacity:1}100%{transform:translate(var(--dx),var(--dy)) scale(1);opacity:0}}

  /* ì‚¬ìš´ë“œ ì•ˆë‚´ & í† ê¸€ */
  .sound-tip{position:fixed;right:10px;bottom:10px;font-size:12px;color:#9fb4d1;background:#0f1830;border:1px solid #2a3a58;border-radius:10px;padding:6px 10px;z-index:5}
  .audio-toggle{position:fixed;right:12px;bottom:12px;width:44px;height:44px;border:1px solid #2a3a58;border-radius:12px;background:#0f1830cc;
    backdrop-filter:blur(6px);color:#cfe8ff;font-size:20px;line-height:44px;text-align:center;cursor:pointer;z-index:6;}
  .audio-toggle:active{transform:scale(.96)}

  /* ì‘ì€ í™”ë©´ì—ì„œ í™”ì‚´í‘œë¥¼ ì¹´ë“œ ì•ˆìª½ìœ¼ë¡œ */
  @media (max-width: 420px){
    .arrow.prev{left:4px}
    .arrow.next{right:4px}
  }

  /* ===================== Instagram-like Design Only ===================== */
  /* í™”ì‚´í‘œ: ì¸ìŠ¤íƒ€ ìŠ¤íƒ€ì¼ (ìœ„ì¹˜ ì„¤ì •ì€ ê¸°ì¡´ ì½”ë“œ ìœ ì§€) */
  .arrow{
    position: absolute;  z-index: 6;
    top: 50%;
    transform: translateY(-50%);
    width: 36px; height: 36px;
    border: none; border-radius: 999px;
    background: rgba(0,0,0,.35);
    box-shadow: 0 2px 8px rgba(0,0,0,.35);
    transition: background .2s ease, transform .12s ease;
  }

  /* í°ìƒ‰ > < ëª¨ì–‘ */
  .arrow::before{ 
    content:"";
    position: absolute;
    left: 50%; top: 50%;
    width: 14px; height: 14px;          /* ğŸ”§ ì•„ì´ì½˜ í¬ê¸° */
    transform: translate(-50%, -50%);   /* ì •í™•í•œ ì¤‘ì•™ ì •ë ¬ */
    background: center / contain no-repeat
      url('data:image/svg+xml;utf8,\<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" \stroke="white" stroke-width="2.2" fill="none" stroke-linecap="round" stroke-linejoin="round"> \<path d="M9 6l6 6-6 6"/></svg>'); 
  }

  /* í™”ì‚´í‘œ ìœ„ì¹˜ */
  .arrow.prev{ left: 10px;/* ì¹´ë“œ ì•ˆìª½ìœ¼ë¡œ ë„£ê¸° */ }
  .arrow.next{ right: 10px;/* ì¹´ë“œ ì•ˆìª½ìœ¼ë¡œ ë„£ê¸° */ }
  .arrow.prev::before{ transform: translate(-50%, -50%) scaleX(-1); }  

  /* íš¨ê³¼ */
  .arrow:hover{ background: rgba(0,0,0,.5); opacity: .8; }
  .arrow:active{ transform: translateY(-50%) scale(.95); }
  .arrow[hidden]{ visibility:hidden; }

  /* ì‘ì€ í™”ë©´ì—ì„œëŠ” ì¡°ê¸ˆ ë” ë¶™ì—¬ì¤Œ */
  @media (max-width:420px){
    .arrow.prev{ left:4px }
    .arrow.next{ right:4px }
  }
  .arrow:disabled { opacity:.35; pointer-events:none; }

  /* ì  ë„¤ë¹„: ì¸ìŠ¤íƒ€ ìŠ¤íƒ€ì¼ */ 
  .dots{ display:flex; gap:6px; justify-content:center; margin-top:12px; } 
  .dot{ width: 6px; height: 6px; border-radius: 999px; background: #a1a1a1; opacity: .6; border: none; transition: transform .2s ease, opacity .2s ease, background .2s ease; } 
  .dot.active{ background: #9ff3ff; opacity: 1; transform: scale(1.15); }

</style>
</head>
<body>
<div class="scene" id="scene">
  <div class="stars" id="stars"></div>

  <div class="sun" aria-hidden="true">â˜€ï¸</div>
  <div class="earth" id="earth" aria-label="ì§€êµ¬">ğŸŒ</div>
  <div class="counter" id="counter">ğŸ‘¤ 0 / 10</div>
  <button id="audioToggle" class="audio-toggle" aria-pressed="false" aria-label="Sound off">ğŸ”‡</button>

  <header class="header">
    <div class="neon">ğŸ«§Secret Access for DomiğŸŸ</div>
    <div class="sub">ìƒì¼ ìš°ì£¼ì— ì ‘ì†í–ˆìŠµë‹ˆë‹¤.<br>ë¹ŒëŸ°(ğŸ‘¤) 10ëª…ì„ í‡´ì¹˜í•˜ë©´ ì´ë²¤íŠ¸ê°€ ì‹œì‘ë©ë‹ˆë‹¤.</div>
  </header>

  <!-- ===== ì¹´ë“œ ìºëŸ¬ì…€ ===== -->
  <section class="carousel" id="carousel" aria-roledescription="carousel">
    <!-- í™”ì‚´í‘œ (ì¹´ë“œ ìœ„ ê²¹ì¹¨) -->
    <button class="arrow prev" id="prevBtn" aria-label="ì´ì „ ì¹´ë“œ ë³´ê¸°"></button>
    <button class="arrow next" id="nextBtn" aria-label="ë‹¤ìŒ ì¹´ë“œ ë³´ê¸°"></button>

    <div class="slides" id="slides">
      <!-- slide 1 -->
      <div class="slide" role="group" aria-roledescription="slide" aria-label="1 / 4">
        <div class="card">
          <div class="dear">ğŸŒ±ë„ë¯¸ëƒ¥ì˜ í‰í™”ë¡œìš´ í•˜ë£¨ğŸ±</div>
          <div class="msg" style="text-align: center;">
            ëƒ¥
            ëƒ¥ëƒ¥
            ëƒ¥ëƒ¥ëƒ¥
            ëƒ¥ëƒ¥ëƒ¥ëƒ¥
            ëƒ¥ëƒ¥ëƒ¥ëƒ¥ëƒ¥
            ëƒ¥ëƒ¥ëƒ¥ëƒ¥ëƒ¥ëƒ¥
            ëƒëƒëƒëƒëƒëƒëƒ¥!

          </div>
          <div class="sig">ğŸ¶ë»ë”ğŸ«§ğŸŸ</div>
        </div>
      </div>

      <!-- slide 2 -->
      <div class="slide" role="group" aria-roledescription="slide" aria-label="2 / 4">
        <div class="card">
          <div class="dear">Hidden Feature for DomiğŸŸ</div>
          <div class="msg">
                          ì§€êµ¬ì˜ í‰í™”ëŠ” ë„ë¯¸ì˜ ì† ëì— ë‹¬ë ¸ë‹¤ğŸŒ±ğŸ±
                          ğŸŒë¥¼ í´ë¦­í•˜ë©´ ë¹ŒëŸ°ë“¤ì„ íƒœìš´ ğŸš€ì´ ë°œì‚¬ë©ë‹ˆë‹¤ğŸ˜
                          ğŸŸë§ˆìŒì˜ í‰í™”ë¥¼ ê¹¨ëœ¨ë¦¬ëŠ” ë¹ŒëŸ° ë°œìƒì‹œ,
                          ì–¸ì œë“  ìš°ì£¼ì„ ì„ ë°œì‚¬í•´ì£¼ì„¸ìš”ğŸ˜‰
                          
                          <strong>* ë„ë¯¸ë¥¼ ìœ„í•œ ìš°ì£¼ì„ ì€ ë¬´ì œí•œ ì œê³µ ë©ë‹ˆë‹¤ğŸš€</strong>
                        
          </div>
          <div class="sig">â€” Secret Supporter ğŸ’ƒğŸ§±</div>
        </div>
      </div>

      <!-- slide 3 -->
      <div class="slide" role="group" aria-roledescription="slide" aria-label="3 / 4">
        <div class="card">
          <div class="dear">Dear ğŸŸ</div>
          <div class="msg">
                          í˜„ìµì•„, ìƒì¼ ì¶•í•˜í•´ğŸ¥³
                          ë§›ìˆëŠ” ê±° ë§~ì´ ë¨¹ê³ ğŸ·
                          ì¦ê²ê³  í–‰ë³µí•œ í•˜ë£¨ ë³´ë‚´ğŸ˜Š
                          ì¹´ë“œë¥¼ ì§ì ‘ ëª» ì¤˜ì„œ ì•„ì‰½ì§€ë§Œ ë§˜ì—ë“¤ë©´ ì¢‹ê² ë‹¤ğŸ¤­
                          í•­ìƒ ë‚´ í•˜ë£¨ì˜ ëì— ìˆì–´ì¤˜ì„œ ê³ ë§ˆì›ŒğŸ¥°
                          ì•ìœ¼ë¡œì˜ ë§¤ì¼ì—ë„ ì›ƒìŒê³¼ í–‰ë³µì´ ê°€ë“í•˜ê¸¸ğŸŒ»
                          ğŸ‚Happy BirthdayğŸ

            </div>
          <div class="sig">From ğŸ„</div>
        </div>
      </div>
      
      <!-- slide 4 -->
      <div class="slide" role="group" aria-roledescription="slide" aria-label="4 / 4">
        <div class="card">
          <div class="dear">Dear ğŸŸ</div>
          <div class="msg">ë‹ˆí•˜ì˜¤ ë„ë¯¸!
                          ìƒê°ì²˜ëŸ¼ ëª¨ë“  ê²Œ ì˜ í’€ë¦¬ì§€ ì•Šì•„ì„œ í¬ê¸°í•˜ë ¤ë˜ ë•Œ,
                          ë„ ë§Œë‚˜ë©´ì„œ ëª¨ë“  ê²Œ ë‹¤ì‹œ ì‹œì‘ëœ ê²ƒ ê°™ì•„.
                          ì•„ì§ ê°ˆ ê¸¸ì´ ë©€ì§€ë§Œ, ë‚´ê°€ ì›í•˜ë˜ ê¸¸ì„ ì°¾ì€ ë§Œí¼
                          í¬ê¸°í•˜ì§€ ì•Šê³  ëê¹Œì§€ í•´ë³¼ê±°ì•¼.
                          í•­ìƒ ì‘ì›í•´ì¤˜ì„œ ê³ ë§ˆì›ŒğŸ¥°
                          ë‚˜ë„ ë„ˆì—ê²Œ í˜ì´ ë˜ëŠ” ì‚¬ëŒì´ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤ğŸ˜Š
                          ë„¤ê°€ ë‚˜ì—ê²Œ ê·¸ëŸ° ì¡´ì¬ì¸ ê²ƒì²˜ëŸ¼!
                          ì•ìœ¼ë¡œë„ í•¨ê»˜í•˜ëŠ” ì‹œê°„ë“¤ì´ í–‰ë³µí•˜ê³  ì¦ê²ê¸°ë¥¼ğŸ’•
                          ìƒì¼ ë„ˆë¬´ë„ˆë¬´ ì¶•í•˜í•´ğŸ¥³ğŸ‚</div>
          <div class="sig">From ğŸ„</div>
        </div>
      </div>
    </div>

    <!-- ì  ë„¤ë¹„ -->
    <div class="dots" id="dots" role="tablist" aria-label="ì¹´ë“œ ì´ë™ ì  ë„¤ë¹„ê²Œì´ì…˜"></div>
  </section>

  <div class="people" id="people"></div>

  <div class="rocket" id="rocket">ğŸš€</div>
  <div class="final" id="final"><div class="bubble">Always cheering for you, Hyun Ik ğŸ’•</div></div>

  <div class="burst" id="burst"></div>

  <!-- Happy Birthday to You -->
  <!-- <iframe id="bgm" data-video-id="bZ7Nh4K9gII" width="0" height="0"
    src="https://www.youtube.com/embed/bZ7Nh4K9gII?enablejsapi=1&autoplay=1&mute=1&playsinline=1&loop=1&playlist=bZ7Nh4K9gII&rel=0&modestbranding=1"
    frameborder="0" allow="autoplay; encrypted-media"></iframe> -->
  
  <!-- Domi domi doremi Playlist: https://www.youtube.com/playlist?list=PLtuRlaWtDzbsva8iJAkP5UzvmiGZckNA1 -->
  <iframe id="bgm" width="0" height="0"
    src="https://www.youtube.com/embed?enablejsapi=1&listType=playlist&list=PLtuRlaWtDzbsva8iJAkP5UzvmiGZckNA1&autoplay=1&mute=1&playsinline=1&loop=1&rel=0&modestbranding=1&index=0"
    frameborder="0" allow="autoplay; encrypted-media"></iframe>

  <div class="sound-tip" id="soundTip">ğŸ”Š ìë™ì¬ìƒì´ ì•ˆ ë“¤ë¦¬ë©´ í™”ë©´ì„ í•œ ë²ˆ í„°ì¹˜í•´ ì£¼ì„¸ìš”.</div>
</div>

<script>
  /* ===== ìœ í‹¸ ===== */
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const rand = (a,b)=>Math.random()*(b-a)+a;
  const vw = ()=>Math.max(document.documentElement.clientWidth||0, window.innerWidth||0);
  const vh = ()=>Math.max(document.documentElement.clientHeight||0, window.innerHeight||0);
  const clamp=(n,min,max)=>Math.min(Math.max(n,min),max);
  const center=el=>{const r=el.getBoundingClientRect();return {x:r.left+r.width/2,y:r.top+r.height/2,w:r.width,h:r.height}};

  /* ===== ì„¤ì • ===== */
  const PERSON_COUNT = 10;
  const EXTRA_DELAY  = 800;
  const ROCKET_MS    = 4800;  // â† ë¡œì¼“ ì†ë„

  /* ===== ë³„ ===== */
  const stars = $('#stars'); const STAR_COUNT = 140;
  for(let i=0;i<STAR_COUNT;i++){
    const s=document.createElement('div'); s.className='star';
    s.style.left=rand(0,100)+'%'; s.style.top=rand(0,100)+'%';
    const size=rand(1.2,3.4); s.style.width=size+'px'; s.style.height=size+'px';
    s.style.animationDelay=(Math.random()*2)+'s'; stars.appendChild(s);
  }

  /* ===== ì¹´ë“œ ìºëŸ¬ì…€ ë¡œì§ ===== */
  const slidesEl = $('#slides');
  const slideEls = $$('#slides .slide');
  const dotsEl = $('#dots');
  const prevBtn = $('#prevBtn');
  const nextBtn = $('#nextBtn');

  let idx = 0;
  const last = slideEls.length - 1;

  // ì  ìƒì„±
  slideEls.forEach((_,i)=>{
    const d=document.createElement('button');
    d.className='dot'; d.type='button'; d.setAttribute('role','tab');
    d.setAttribute('aria-label', `${i+1}ë²ˆ ì¹´ë“œë¡œ ì´ë™`);
    d.addEventListener('click', ()=>goTo(i));
    dotsEl.appendChild(d);
  });

  let prevIdx = -1;
  function render(){
    slidesEl.style.transform = `translateX(${-idx*100}%)`;
    $$('#dots .dot').forEach((d,i)=>d.classList.toggle('active', i===idx));
    // í™”ì‚´í‘œ í‘œì‹œ/ìˆ¨ê¹€
    prevBtn.toggleAttribute('hidden', idx === 0);
    nextBtn.toggleAttribute('hidden', idx === last);
    // í™”ì‚´í‘œ ë§¨ ì•, ë§¨ ë ë¹„í™œì„±
    prevBtn.disabled = (idx === 0); 
    nextBtn.disabled = (idx === last);
    // ARIA í˜„ì¬ ìŠ¬ë¼ì´ë“œ ë¼ë²¨ ê°±ì‹ 
    slideEls.forEach((s,i)=>s.setAttribute('aria-label', `${i+1} / ${last+1}`));
  }
  function goTo(i){ idx = clamp(i,0,last); render(); }
  function prev(){ if(idx>0) { idx--; render(); } }
  function next(){ if(idx<last){ idx++; render(); } }

  prevBtn.addEventListener('click', prev);
  nextBtn.addEventListener('click', next);

  // í‚¤ë³´ë“œ ë‚´ë¹„
  window.addEventListener('keydown', (e)=>{
    if (e.key==='ArrowLeft') prev();
    else if (e.key==='ArrowRight') next();
  });

  // í„°ì¹˜/ë“œë˜ê·¸ ìŠ¤ì™€ì´í”„
  (function swipeable(){
    let startX=0, curX=0, dragging=false;
    const threshold=40, lock=()=>slidesEl.style.transition='none', unlock=()=>slidesEl.style.transition='';
    slidesEl.addEventListener('pointerdown',e=>{
      dragging=true; startX=e.clientX; curX=startX; lock();
      slidesEl.setPointerCapture?.(e.pointerId);
    });
    window.addEventListener('pointermove',e=>{
      if(!dragging) return;
      curX=e.clientX;
      let dx=curX-startX;
      if (idx === 0 && dx > 0) dx = 0;        // ì²« ì¹´ë“œì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë°€ë©´ ë¬´ì‹œ
      if (idx === last && dx < 0) dx = 0;     // ë§ˆì§€ë§‰ ì¹´ë“œì—ì„œ ì™¼ìª½ìœ¼ë¡œ ë°€ë©´ ë¬´ì‹œ
      slidesEl.style.transform=`translateX(${(-idx*100)+(dx/vw()*100)}%)`;
    }, {passive:false});
    const end=()=>{
      if(!dragging) return; dragging=false; unlock();
      const dx=curX-startX;
      if(Math.abs(dx)>threshold){
        if(dx>0) prev(); else next();
      } else {
        render();
      }
    };
    window.addEventListener('pointerup', end);
    window.addEventListener('pointercancel', end);
  })();

  render();

  /* ===== ì‚¬ëŒ ===== */
  const peopleWrap=$('.people'), earth=$('#earth'), counter=$('#counter');
  const SAFE=80; let rescued=0; const people=[];
  function spawnPerson(){
    const p=document.createElement('div'); p.className='person'; p.textContent='ğŸ‘¤';
    p.style.left=rand(SAFE, vw()-SAFE)+'px';
    p.style.top =rand(120, vh()-140)+'px';
    p.style.animationDelay=rand(0,3)+'s';
    p.addEventListener('click', ()=>sendToEarth(p));
    peopleWrap.appendChild(p); people.push(p);
  }
  for(let i=0;i<PERSON_COUNT;i++) spawnPerson();

  function earthCenter(){ const r=earth.getBoundingClientRect(); return {x:r.left+r.width/2,y:r.top+r.height/2}; }

  let launchScheduled=false;

  function sendToEarth(node){
    if(node.classList.contains('to-earth')) return;
    const rect=node.getBoundingClientRect(); const ec=earthCenter();
    requestAnimationFrame(()=>{
      node.classList.add('to-earth');
      node.style.left=(ec.x-rect.width/2)+'px';
      node.style.top =(ec.y-rect.height/2)+'px';
      node.style.opacity='.15';
    });
    rescued++; counter.textContent=`ğŸ‘¤ ${rescued} / ${PERSON_COUNT}`;
    const onEnd=()=>{ node.removeEventListener('transitionend',onEnd); node.remove();
      if(rescued===PERSON_COUNT && !launchScheduled){ launchScheduled=true; setTimeout(launchSequence,EXTRA_DELAY); }
    };
    node.addEventListener('transitionend', onEnd);
  }

  /* ===== ì§€êµ¬ í´ë¦­ ì¶”ê°€ ë°œì‚¬ ===== */
  let earthLaunchArmed=false, earthLaunchCooldown=false;
  earth.addEventListener('click', ()=>{
    if(!earthLaunchArmed || earthLaunchCooldown) return;
    earthLaunchCooldown=true; spawnExtraRocket(); setTimeout(()=>earthLaunchCooldown=false,400);
  });

  /* ===== ë¡œì¼“/í”¼ë‚ ë ˆ ===== */
  const sun=$('.sun'), rocket=$('#rocket'), final=$('#final'), burst=$('#burst');

  function launchSequence(){
    const ec=center(earth), sc=center(sun);

    // ë¡œì¼“ ì¶œë°œ = ì§€êµ¬ ì¤‘ì‹¬
    const rSize=28;
    rocket.style.left=(ec.x - rSize/2)+'px';
    rocket.style.top =(ec.y - rSize/2)+'px';
    rocket.style.bottom='auto';

    // ì´ë™ëŸ‰ + ì‹œê°„
    const dx=sc.x-ec.x, dy=sc.y-ec.y;
    rocket.style.setProperty('--tx', `${dx}px`);
    rocket.style.setProperty('--ty', `${dy}px`);
    rocket.style.setProperty('--rocket-duration', `${ROCKET_MS}ms`);

    rocket.classList.add('launch');

    rocket.addEventListener('animationend', ()=>{
      rocket.style.opacity='0';
      const ex=document.createElement('div');
      ex.className='explosion'; ex.textContent='ğŸ’¥';
      ex.style.left=`${sc.x}px`; ex.style.top=`${sc.y}px`;
      document.body.appendChild(ex); setTimeout(()=>ex.remove(),900);

      // í”¼ë‚ ë ˆ UI
      final.classList.add('show');
      initBubbleDrag();
      confettiBurst();
      $('#soundTip')?.remove();

      // ì‚¬ëŒ ë ˆì´ì–´ í´ë¦­í†µê³¼
      peopleWrap.style.pointerEvents = 'none';

      // ì§€êµ¬ ì¶”ê°€ ë°œì‚¬ í™œì„±í™”
      earthLaunchArmed = true;
      earth.classList.add('launchable');
    }, {once:true});
  }

  function spawnExtraRocket(){
    const ec=center(earth), sc=center(sun);
    const r=document.createElement('div'); r.className='rocket'; r.textContent='ğŸš€'; document.body.appendChild(r);
    const rSize=28;
    r.style.left=(ec.x - rSize/2)+'px'; r.style.top=(ec.y - rSize/2)+'px'; r.style.bottom='auto';
    const dx=sc.x-ec.x, dy=sc.y-ec.y;
    r.style.setProperty('--tx', `${dx}px`);
    r.style.setProperty('--ty', `${dy}px`);
    r.style.setProperty('--rocket-duration', `${ROCKET_MS}ms`);
    r.classList.add('launch');
    r.addEventListener('animationend', ()=>{
      r.style.opacity='0';
      const ex=document.createElement('div'); ex.className='explosion'; ex.textContent='ğŸ’¥';
      ex.style.left=`${sc.x}px`; ex.style.top=`${sc.y}px`; document.body.appendChild(ex);
      setTimeout(()=>ex.remove(),900); setTimeout(()=>r.remove(),50);
    }, {once:true});
  }

  function confettiBurst(){
    const EMOJIS=['ğŸ‰','ğŸˆ','â­ï¸','ğŸ«§','ğŸŒŸ','âœ¨','ğŸ’™','ğŸŒ»','ğŸŸ','ğŸ¶','ğŸŒ±','ğŸ±','ğŸŒ™','ğŸ¡','ğŸ¬','ğŸ³','ğŸ‚','ğŸ'];
    for(let i=0;i<26;i++){
      const c=document.createElement('div'); c.className='confetti';
      c.textContent=EMOJIS[Math.floor(Math.random()*EMOJIS.length)];
      const angle=rand(0,2*Math.PI), dist=rand(80,220);
      c.style.setProperty('--dx', Math.cos(angle)*dist+'px');
      c.style.setProperty('--dy', Math.sin(angle)*dist+'px');
      c.style.left='0px'; c.style.top='0px'; burst.appendChild(c);
      setTimeout(()=>c.style.opacity='1',10); setTimeout(()=>c.remove(),3600);
    }
  }

  /* ===== ì˜¤ë””ì˜¤ ===== */
  const bgm=$('#bgm'); let audioArmed=false;
  function ytCmd(func,args=[]){ bgm.contentWindow?.postMessage(JSON.stringify({event:'command',func,args}), '*'); }

  const audioBtn = $('#audioToggle'); let audioOn=false;
  function updateAudioIcon(){ audioBtn.textContent=audioOn?'ğŸ”Š':'ğŸ”‡'; audioBtn.setAttribute('aria-pressed', audioOn?'true':'false'); }
  function armAudio(){ if(audioArmed) return; audioArmed=true; ytCmd('unMute'); ytCmd('playVideo'); audioOn=true; updateAudioIcon(); $('#soundTip')?.remove();
    window.removeEventListener('pointerdown',armAudio); window.removeEventListener('keydown',armAudio); }
  window.addEventListener('pointerdown',armAudio); window.addEventListener('keydown',armAudio);
  function toggleAudio(){
    if(!audioArmed){ armAudio(); return; }
    audioOn=!audioOn; audioOn?(ytCmd('unMute'),ytCmd('playVideo')):(ytCmd('mute'),ytCmd('pauseVideo')); updateAudioIcon();
  }
  audioBtn.addEventListener('click', toggleAudio);
  updateAudioIcon();

  /* ë¦¬ì‚¬ì´ì¦ˆ: ì‚¬ëŒ ìœ„ì¹˜ ë³´ì • */
  window.addEventListener('resize', ()=>{
    people.forEach(p=>{ if(!p.isConnected) return;
      const r=p.getBoundingClientRect();
      const nx=clamp(r.left, 80, vw()-80-r.width);
      const ny=clamp(r.top , 120 , vh()-140-r.height);
      p.style.left=nx+'px'; p.style.top=ny+'px';
    });
  });

  /* í”¼ë‚ ë ˆ ë©”ì‹œì§€ ë“œë˜ê·¸ */
  function initBubbleDrag(){
    const bubble=$('.final .bubble'); if(!bubble) return; bubble.classList.add('glow');
    let dragging=false, offX=0, offY=0; const margin=8;
    const clip=(n,min,max)=>Math.min(Math.max(n,min),max);

    bubble.addEventListener('pointerdown',e=>{
      dragging=true; bubble.setPointerCapture?.(e.pointerId);
      const r=bubble.getBoundingClientRect();
      bubble.style.width=r.width+'px';  // iOS í­ ê³ ì •
      bubble.style.left=r.left+'px'; bubble.style.top=r.top+'px'; bubble.style.transform='none';
      offX=e.clientX-r.left; offY=e.clientY-r.top; bubble.style.cursor='grabbing';
    });
    window.addEventListener('pointermove',e=>{
      if(!dragging) return; const w=bubble.offsetWidth,h=bubble.offsetHeight;
      let nx=e.clientX-offX, ny=e.clientY-offY;
      nx=clip(nx, margin, window.innerWidth-w-margin);
      ny=clip(ny, margin, window.innerHeight-h-margin);
      bubble.style.left=nx+'px'; bubble.style.top=ny+'px';
    }, {passive:false});
    window.addEventListener('pointerup',()=>{ dragging=false; bubble.style.cursor='grab'; });
  }
</script>
</body>
</html>